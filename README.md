# RequestsAnomalyAnalysis
Выявление аномалий в обращениях потребителей в АО "Сетевая компания" по причине качества электроэнергии

*** ПРЕДОБРАБОТКА ***

В данной работе использвался машинный алгоритм ufal.udpipe для предобраотки обращений потребителей.
Предобработка включается в себя лемматизацию и токенизацию данных. В качестве модели используется udpipe_syntagrus.model для русскоязычных текстов.

*** ВЕКТОРИЗАЦИЯ ТЕКСТА ***

Для векторизации текста используется предобученная модель Word2Vec по методу SkipGram (определение контекста на основе центрального слова).
В качестве модели взята word2vec-ruscorpora-300.model. Она была обучена на корпусе из порядка 250М слов в сети Интернет: википедии, отзывы, различные сайты.
Данная модель была дообучена на специализированных данных профессионального направления для разрушения баланса имеющихся у нее знаний. Это помогает модели адаптироваться под конкретную отрасль деятельности, перенастраивая эмбеддинги токенов словаря.

*** ЭМБЕДДИНГИ ОБРАЩЕНИЙ ***

Эмбеддинги обращений были получены с использованием данных словаря, эмбеддингов токенов и алгоритма частотности слов TF-IDF. 
Определяемая взвешенная сумма эмбеддингов токенов в обращении, умноженная скалярно на значения TF-IDF, позволяет определять некоторую топологию обращений и выявлять их паттерны.

*** КЛАСТЕРИЗАЦИЯ ***

Кластеризация обращений осуществляется с помощью нейронной сети Кохонена, обученной с нуля. Каждый кластер содержит 4 базовых класса и 1 аномальный класс.
Вероятности, с которыми обращения в будущем будут принадлежать тому или иному кластеру, зависят от того, какие обращение попали на этапе обучения в кластер.
Обращения, принадлежащие стандартным классом, определяются на основе входящих в них триггерных слов. Аномальный класс называется произвольно.
Помимо прочего, в программе содержится 2 фиксированных аномальных кластера с 1 классом-аномалией: Неопознанные обращения и обращения, которые встречаются редко и требуют внимания. Это было сделано в целях разрешения исключительных ситуаций при работе программы.

*** РЕЗУЛЬТАТ ***

На вход подается .xlsb файл или текстовое обращения. На выходе: .xlsx файл с указанным распределением вероятностей классов в кластере или просто отображение последнего соответственно.
Анализируемый столбец в .xlsb файле: Суть обращения.
Настоятельно не рекомендуется изменять конфиг программы без уверенности в своих действиях.

!!!ДИСКЛЕЙМЕР!!! Автор не несет ответственности за применение указанной программы в профессиональных целях.
